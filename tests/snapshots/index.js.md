# Snapshot report for `tests/index.js`

The actual snapshot is saved in `index.js.snap`.

Generated by [AVA](https://avajs.dev).

## action-deprecated-inputs.test.js

> stderr

    ''

> stdout

    ''

## main-custom-github-api-url.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are set. Creating token for the following repositories:␊
          ␊
    - actions/create-github-app-token␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /api/v3/repos/actions/create-github-app-token/installation␊
    POST /api/v3/app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token"]}`

## main-enterprise-installation-not-found.test.js

> stderr

    `Error: No enterprise installation found matching the name test-enterprise. Available installations: Organization:some-org, User:some-user␊
        at getTokenFromEnterprise (file:///Users/s/dev/create-github-app-token/lib/main.js:229:11)␊
        at process.processTicksAndRejections (node:internal/process/task_queues:105:5)␊
        at async RetryOperation._fn (file:///Users/s/dev/create-github-app-token/node_modules/p-retry/index.js:55:20) {␊
      attemptNumber: 1,␊
      retriesLeft: 3␊
    }`

> stdout

    `Creating enterprise installation token for enterprise "test-enterprise".␊
    Failed to create token for enterprise "test-enterprise" (attempt 1): No enterprise installation found matching the name test-enterprise. Available installations: Organization:some-org, User:some-user␊
    --- REQUESTS ---␊
    GET /app/installations`

## main-enterprise-mutual-exclusivity-both.test.js

> stderr

    `Error: Cannot use 'enterprise-slug' input with 'owner' or 'repositories' inputs␊
        at main (file:///Users/s/dev/create-github-app-token/lib/main.js:31:11)␊
        at file:///Users/s/dev/create-github-app-token/main.js:33:16␊
        at ModuleJob.run (node:internal/modules/esm/module_job:274:25)␊
        at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:644:26)␊
        at async file:///Users/s/dev/create-github-app-token/tests/main-enterprise-mutual-exclusivity-both.test.js:13:3`

> stdout

    ''

## main-enterprise-mutual-exclusivity-owner.test.js

> stderr

    `Error: Cannot use 'enterprise-slug' input with 'owner' or 'repositories' inputs␊
        at main (file:///Users/s/dev/create-github-app-token/lib/main.js:31:11)␊
        at file:///Users/s/dev/create-github-app-token/main.js:33:16␊
        at ModuleJob.run (node:internal/modules/esm/module_job:274:25)␊
        at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:644:26)␊
        at async file:///Users/s/dev/create-github-app-token/tests/main-enterprise-mutual-exclusivity-owner.test.js:12:3`

> stdout

    ''

## main-enterprise-mutual-exclusivity-repositories.test.js

> stderr

    `Error: Cannot use 'enterprise-slug' input with 'owner' or 'repositories' inputs␊
        at main (file:///Users/s/dev/create-github-app-token/lib/main.js:31:11)␊
        at file:///Users/s/dev/create-github-app-token/main.js:33:16␊
        at ModuleJob.run (node:internal/modules/esm/module_job:274:25)␊
        at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:644:26)␊
        at async file:///Users/s/dev/create-github-app-token/tests/main-enterprise-mutual-exclusivity-repositories.test.js:12:3`

> stdout

    ''

## main-enterprise-only-success.test.js

> stderr

    ''

> stdout

    `Creating enterprise installation token for enterprise "test-enterprise".␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /app/installations␊
    POST /app/installations/123456/access_tokens␊
    null`

## main-enterprise-token-success.test.js

> stderr

    ''

> stdout

    `Creating enterprise installation token for enterprise "test-enterprise".␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /app/installations␊
    POST /app/installations/123456/access_tokens␊
    null`

## main-enterprise-token-with-permissions.test.js

> stderr

    ''

> stdout

    `Creating enterprise installation token for enterprise "test-enterprise".␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /app/installations␊
    POST /app/installations/123456/access_tokens␊
    {"permissions":{"enterprise_organizations":"read","enterprise_people":"write"}}`

## main-missing-owner.test.js

> stderr

    'GITHUB_REPOSITORY_OWNER missing, must be set to \'<owner>\''

> stdout

    ''

## main-missing-repository.test.js

> stderr

    'GITHUB_REPOSITORY missing, must be set to \'<owner>/<repo>\''

> stdout

    ''

## main-private-key-with-escaped-newlines.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are not set. Creating token for this repository (actions/create-github-app-token).␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token"]}`

## main-repo-skew.test.js

> stderr

    `'Issued at' claim ('iat') must be an Integer representing the time that the assertion was issued.␊
    [@octokit/auth-app] GitHub API time and system time are different by 30 seconds. Retrying request with the difference accounted for.`

> stdout

    `Inputs 'owner' and 'repositories' are set. Creating token for the following repositories:␊
          ␊
    - actions/failed-repo␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/failed-repo/installation␊
    GET /repos/actions/failed-repo/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["failed-repo"]}`

## main-token-get-owner-set-fail-response.test.js

> stderr

    ''

> stdout

    `Input 'repositories' is not set. Creating token for all repositories owned by smockle.␊
    Failed to create token for "smockle" (attempt 1): GitHub API not available␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /users/smockle/installation␊
    GET /users/smockle/installation␊
    POST /app/installations/123456/access_tokens␊
    null`

## main-token-get-owner-set-repo-fail-response.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are set. Creating token for the following repositories:␊
          ␊
    - actions/failed-repo␊
    Failed to create token for "failed-repo" (attempt 1): GitHub API not available␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/failed-repo/installation␊
    GET /repos/actions/failed-repo/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["failed-repo"]}`

## main-token-get-owner-set-repo-set-to-many-newline.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are set. Creating token for the following repositories:␊
          ␊
    - actions/create-github-app-token␊
    - actions/toolkit␊
    - actions/checkout␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token","toolkit","checkout"]}`

## main-token-get-owner-set-repo-set-to-many.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are set. Creating token for the following repositories:␊
          ␊
    - actions/create-github-app-token␊
    - actions/toolkit␊
    - actions/checkout␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token","toolkit","checkout"]}`

## main-token-get-owner-set-repo-set-to-one.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are set. Creating token for the following repositories:␊
          ␊
    - actions/create-github-app-token␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token"]}`

## main-token-get-owner-set-repo-unset.test.js

> stderr

    ''

> stdout

    `Input 'repositories' is not set. Creating token for all repositories owned by actions.␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /users/actions/installation␊
    POST /app/installations/123456/access_tokens␊
    null`

## main-token-get-owner-unset-repo-set.test.js

> stderr

    ''

> stdout

    `No 'owner' input provided. Using default owner 'actions' to create token for the following repositories:␊
    - actions/create-github-app-token␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token"]}`

## main-token-get-owner-unset-repo-unset.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are not set. Creating token for this repository (actions/create-github-app-token).␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token"]}`

## main-token-permissions-set.test.js

> stderr

    ''

> stdout

    `Inputs 'owner' and 'repositories' are not set. Creating token for this repository (actions/create-github-app-token).␊
    ::add-mask::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ␊
    ::set-output name=installation-id::123456␊
    ␊
    ::set-output name=app-slug::github-actions␊
    ::save-state name=token::ghs_16C7e42F292c6912E7710c838347Ae178B4a␊
    ::save-state name=expiresAt::2016-07-11T22:14:10Z␊
    --- REQUESTS ---␊
    GET /repos/actions/create-github-app-token/installation␊
    POST /app/installations/123456/access_tokens␊
    {"repositories":["create-github-app-token"],"permissions":{"issues":"write","pull_requests":"read"}}`

## post-revoke-token-fail-response.test.js

> stderr

    ''

> stdout

    '::warning::Token revocation failed: '

## post-token-expired.test.js

> stderr

    ''

> stdout

    'Token expired, skipping token revocation'

## post-token-set.test.js

> stderr

    ''

> stdout

    'Token revoked'

## post-token-skipped.test.js

> stderr

    ''

> stdout

    'Token revocation was skipped'

## post-token-unset.test.js

> stderr

    ''

> stdout

    'Token is not set'
